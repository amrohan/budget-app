<app-layout>
  <header class="w-full h-full flex justify-between items-center">
    <div class="flex flex-col gap-1">
      <p class="text-xl font-bold">Accounts</p>
      <p class="text-sm text-zinc-400 font-semibold">
        Total: <span>INR </span> 269.69
      </p>
    </div>
    <p-button
      label="Create"
      icon="pi pi-plus"
      (click)="showDialog()"
      styleClass="p-button-sm p-button-info"
    ></p-button>
  </header>

  <!-- Accounts -->
  <main class="mt-4 mb-16">
    <ng-container *ngIf="accountsList$ | async as acccount; else loading">
      <article
        *ngFor="let account of this.accountsList$ | async as Account"
        class="h-[12rem] mb-2 w-full bg-zinc-800 rounded-md border-2 border-zinc-600"
      >
        <div class="h-4/6 w-full bg-[#008170] rounded-md rounded-b-none">
          <!-- Account Name -->
          <div class="w-full h-3/6 p-4 flex justify-between items-center gap-3">
            <div class="flex justify-start items-center gap-2">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-6 h-6"
                height="20"
                width="20"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15 8.25H9m6 3H9m3 6l-3-3h1.5a3 3 0 100-6M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                />
              </svg>

              <p class="font-medium text-lg">{{ account.accountName }}</p>
            </div>
            <div>
              <div>
                <button (click)="onCardClick(account._id)">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    height="24"
                    viewBox="0 -960 960 960"
                    width="24"
                    fill="currentColor"
                    class="text-slate-100"
                  >
                    <path
                      d="M480-160q-33 0-56.5-23.5T400-240q0-33 23.5-56.5T480-320q33 0 56.5 23.5T560-240q0 33-23.5 56.5T480-160Zm0-240q-33 0-56.5-23.5T400-480q0-33 23.5-56.5T480-560q33 0 56.5 23.5T560-480q0 33-23.5 56.5T480-400Zm0-240q-33 0-56.5-23.5T400-720q0-33 23.5-56.5T480-800q33 0 56.5 23.5T560-720q0 33-23.5 56.5T480-640Z"
                    />
                  </svg>
                  <!-- <div
                    class="absolute w-fit -translate-x-10 translate-y-[7rem] top-0 right-0 z-30"
                    *ngIf="this.isCardOpen && category._id === clickedItemId"
                  >
                    <p-menu [model]="cardItems"> </p-menu>
                  </div> -->
                </button>
              </div>
            </div>
          </div>
          <!-- Account Remaining Money -->
          <div class="w-full h-3/6 flex justify-center items-start">
            <div class="flex justify-center items-center gap-2">
              <p class="text-3xl font-semibold">269</p>
              <span class="text-lg -translate-y-[.16rem]">.69</span>
              <span class="font-thin text-3xl ml-1">INR</span>
            </div>
          </div>
        </div>
        <div class="h-2/6 bg-white rounded-b-md flex">
          <div
            class="bg-black h-full w-full rounded-b-md rounded-br-none flex flex-col items-center justify-center"
          >
            <div class="w-full text-center mt-1">
              <p class="uppercase text-xs font-medium">income this month</p>
            </div>
            <div class="flex justify-center items-center gap-1">
              <p class="text-xl font-semibold">
                269.69 <span class="font-normal">INR</span>
              </p>
            </div>
          </div>
          <div
            class="bg-black h-full w-full rounded-b-md rounded-bl-none flex flex-col justify-center items-center"
          >
            <div class="w-full text-center mt-1">
              <p class="uppercase text-xs font-medium">expense this month</p>
            </div>
            <div class="flex justify-center items-center gap-1">
              <p class="text-xl font-semibold">
                278.00 <span class="font-normal">INR</span>
              </p>
            </div>
          </div>
        </div>
      </article>
    </ng-container>
    <!-- Loading  -->
    <ng-template #loading>
      <div
        class="h-[12rem] w-full bg-gray-600 mb-2 rounded-md border-2 border-zinc-600 animate-pulse"
      ></div>
      <div
        class="h-[12rem] w-full bg-gray-600 mb-2 rounded-md border-2 border-zinc-600 animate-pulse"
      ></div>
    </ng-template>
  </main>
</app-layout>

<!-- Create Account -->
<p-dialog
  header="Create new account"
  [(visible)]="isCreateAccount"
  [modal]="true"
  [style]="{ width: '90vw' }"
  [draggable]="false"
  [resizable]="false"
>
  <form (ngSubmit)="onSubmit(form)" #form="ngForm">
    <div class="gap-1 flex flex-col">
      <label htmlFor="username" class="text-xs uppercase">Account Name</label>
      <input
        pInputText
        class="p-inputtext-sm"
        id="username"
        aria-describedby="username-help"
        name="accountName"
        [(ngModel)]="accounts.accountName"
      />
    </div>
    <!-- <div class="gap-1 flex flex-col p-fluid mt-2">
      <label class="block text-xs uppercase" for="currency-india"
        >Initial balance</label
      >
      <p-inputNumber
        [(ngModel)]="accounts.amount"
        inputId="locale-user"
        class="p-inputtext-sm"
        [minFractionDigits]="2"
        name="amount"
        [readonly]="true"
      >
      </p-inputNumber>
    </div> -->
    <div class="w-full mt-2 flex justify-end items-start">
      <p-button
        label="Add"
        type="submit"
        icon="pi pi-plus"
        styleClass="p-button-sm  p-button-info"
      ></p-button>
    </div>
  </form>
</p-dialog>

<!-- Update Account -->
<p-dialog
  header="Update account"
  [(visible)]="isCardOpen"
  [modal]="true"
  [style]="{ width: '90vw' }"
  [draggable]="false"
  [resizable]="false"
>
  <form (ngSubmit)="updateAccount(form)" #form="ngForm">
    <div class="gap-1 flex flex-col">
      <label htmlFor="username" class="text-xs uppercase">Account Name</label>
      <input
        pInputText
        class="p-inputtext-sm"
        id="username"
        aria-describedby="username-help"
        name="accountName"
        [(ngModel)]="accounts.accountName"
      />
    </div>
    <!-- <div class="gap-1 flex flex-col p-fluid mt-2">
      <label class="block text-xs uppercase" for="currency-india"
        >Initial balance</label
      >
      <p-inputNumber
        [(ngModel)]="accounts.amount"
        inputId="locale-user"
        class="p-inputtext-sm"
        [minFractionDigits]="2"
        name="amount"
        [readonly]="true"
      >
      </p-inputNumber>
    </div> -->
    <div class="w-full mt-2 flex justify-end items-start gap-2">
      <p-button
        label="Update"
        type="submit"
        styleClass="p-button-sm  p-button-info"
      ></p-button>
      <p-button
        label="Delete"
        type="button"
        (click)="deleteAccount()"
        severity="danger"
        styleClass="p-button-sm  p-button-danger"
      ></p-button>
    </div>
  </form>
</p-dialog>
